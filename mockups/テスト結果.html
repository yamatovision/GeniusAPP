<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI LP Builder - テスト結果分析</title>
  
  <!-- React, ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Material UI -->
  <script src="https://unpkg.com/@mui/material@5.14.5/umd/material-ui.production.min.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
  
  <!-- Emotion (for MUI) -->
  <script src="https://unpkg.com/@emotion/react@11.11.1/dist/emotion-react.umd.min.js"></script>
  <script src="https://unpkg.com/@emotion/styled@11.11.0/dist/emotion-styled.umd.min.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
  
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', 'Helvetica', 'Arial', sans-serif;
      background-color: #f5f7fa;
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .slide-in-up {
      animation: slideInUp 0.4s ease-out;
    }
    
    @keyframes slideInUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .slide-in-right {
      animation: slideInRight 0.4s ease-out;
    }
    
    @keyframes slideInRight {
      from { transform: translateX(20px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    .custom-scrollbar {
      scrollbar-width: thin;
      scrollbar-color: #CBD5E0 #EDF2F7;
    }
    
    .custom-scrollbar::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #EDF2F7;
    }
    
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background-color: #CBD5E0;
      border-radius: 6px;
    }
    
    .variant-preview-iframe {
      border: none;
      width: 100%;
      height: 100%;
      border-radius: 8px;
      background: white;
    }
    
    .highlight-animation {
      animation: highlightPulse 2s infinite;
    }
    
    @keyframes highlightPulse {
      0% { box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(72, 187, 120, 0); }
      100% { box-shadow: 0 0 0 0 rgba(72, 187, 120, 0); }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { 
      createTheme, ThemeProvider, CssBaseline, 
      AppBar, Toolbar, Typography, Button, IconButton, 
      Container, Grid, Paper, Box, Chip, Avatar,
      TextField, InputAdornment, CircularProgress, LinearProgress,
      Tabs, Tab, Table, TableBody, TableCell, TableContainer, TableHead, TableRow,
      Divider, Switch, FormControlLabel, Select, MenuItem, FormControl, InputLabel,
      Card, CardContent, CardMedia, CardActionArea, Tooltip,
      Dialog, DialogTitle, DialogContent, DialogActions, Alert, Collapse,
      List, ListItem, ListItemText, ListItemIcon, ListItemAvatar, Badge, Rating
    } = MaterialUI;
    
    // テーマの作成
    const theme = createTheme({
      palette: {
        primary: {
          main: '#4299e1',
        },
        secondary: {
          main: '#9f7aea',
        },
        success: {
          main: '#48bb78',
        },
        warning: {
          main: '#ed8936',
        },
        error: {
          main: '#f56565',
        },
        background: {
          default: '#f5f7fa',
          paper: '#ffffff',
        },
      },
      typography: {
        fontFamily: "'Roboto', 'Helvetica', 'Arial', sans-serif",
        h4: {
          fontWeight: 600,
        },
        h5: {
          fontWeight: 600,
        },
        h6: {
          fontWeight: 600,
        },
      },
      shape: {
        borderRadius: 10,
      },
      components: {
        MuiButton: {
          styleOverrides: {
            root: {
              textTransform: 'none',
              borderRadius: 8,
              boxShadow: 'none',
              '&:hover': {
                boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)',
              },
            },
            containedPrimary: {
              '&:hover': {
                backgroundColor: '#3182ce',
              },
            },
          },
        },
        MuiPaper: {
          styleOverrides: {
            rounded: {
              borderRadius: 12,
            },
            elevation1: {
              boxShadow: '0px 4px 12px rgba(0, 0, 0, 0.05)',
            }
          },
        },
        MuiChip: {
          styleOverrides: {
            root: {
              borderRadius: 6,
              fontWeight: 500,
            },
          },
        },
        MuiTableCell: {
          styleOverrides: {
            root: {
              padding: '12px 16px',
            },
            head: {
              fontSize: '0.825rem',
              fontWeight: 600,
              color: '#4a5568',
            }
          },
        },
      },
    });
    
    // ErrorBoundary コンポーネント
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { hasError: false, error: null };
      }
      
      static getDerivedStateFromError(error) {
        return { hasError: true, error };
      }
      
      componentDidCatch(error, errorInfo) {
        console.error("Error caught by boundary:", error, errorInfo);
      }
      
      render() {
        if (this.state.hasError) {
          return (
            <Box 
              sx={{ 
                p: 4, 
                display: 'flex', 
                flexDirection: 'column', 
                alignItems: 'center', 
                justifyContent: 'center',
                minHeight: '200px',
                textAlign: 'center'
              }}
            >
              <Typography variant="h6" color="error" gutterBottom>
                エラーが発生しました
              </Typography>
              <Typography variant="body2" color="textSecondary">
                ページの再読み込みをお試しください
              </Typography>
              <Button
                variant="outlined"
                color="primary"
                sx={{ mt: 2 }}
                onClick={() => this.setState({ hasError: false, error: null })}
              >
                再試行
              </Button>
            </Box>
          );
        }
        
        return this.props.children;
      }
    }
    
    // モックデータ - テスト概要
    const mockTestInfo = {
      id: 'test123',
      name: 'ビジネスマネジメントコーチングLPテスト',
      status: 'running', // running, completed, paused
      startDate: '2023-12-15',
      endDate: '2023-12-31',
      currentDate: '2023-12-22',
      progress: 46, // パーセンテージ
      createdAt: '2023-12-14 10:30',
      lpName: 'ビジネスマネジメントコーチングLP',
      conversionGoal: 'form_submit',
      totalVisitors: 1245,
      totalConversions: 53,
      overallConversionRate: 4.26,
      significanceThreshold: 95, // パーセンテージ
      components: [
        {
          id: 'hero',
          name: 'ヒーローセクション',
          winners: [
            { from: '2023-12-15', to: '2023-12-18', variant: 'A' },
            { from: '2023-12-19', to: null, variant: 'B' }
          ]
        },
        {
          id: 'cta', 
          name: 'CTAセクション',
          winners: [
            { from: '2023-12-15', to: null, variant: 'B' }
          ]
        }
      ]
    };
    
    // モックデータ - テストコンポーネント（ヒーローセクション）
    const mockHeroComponent = {
      id: 'hero',
      name: 'ヒーローセクション',
      description: 'ページの最初に表示される、注目を集めるセクション',
      variantA: {
        name: 'ベーシックヘッドライン',
        imgUrl: 'https://images.unsplash.com/photo-1552664730-d307ca884978?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
        headline: 'マネジメントスキルを磨き、真のリーダーへ',
        description: '15年以上の経験を持つ元人事責任者が教える3ヶ月間の実践的コーチングプログラム。',
        visitors: 623,
        conversions: 21,
        conversionRate: 3.37,
        html: `<section class="hero">
          <div class="container">
            <h1>マネジメントスキルを磨き、真のリーダーへ</h1>
            <p>15年以上の経験を持つ元人事責任者が教える3ヶ月間の実践的コーチングプログラム。効率的なチームマネジメント、的確な意思決定、時間管理まで、すぐに実践できるスキルを習得。</p>
            <a href="#pricing" class="cta-button">詳細を見る</a>
          </div>
        </section>`,
        cssClass: 'hero-variant-a',
      },
      variantB: {
        name: 'インパクトある質問見出し',
        imgUrl: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
        headline: 'マネジメントの壁を突破し、キャリアを加速させる',
        description: '現場で15年以上の実績を持つ元人事責任者があなたの成長を徹底サポート。',
        visitors: 622,
        conversions: 32,
        conversionRate: 5.14,
        html: `<section class="hero">
          <div class="container">
            <h1>マネジメントの壁を突破し、<br>キャリアを加速させる</h1>
            <p>現場で15年以上の実績を持つ元人事責任者があなたの成長を徹底サポート。3ヶ月間で200人以上が実証した効果的なリーダーシップ開発プログラム。</p>
            <a href="#pricing" class="cta-button">無料カウンセリングに申し込む</a>
          </div>
        </section>`,
        cssClass: 'hero-variant-b',
      },
      improvement: 52.5, // パーセンテージ
      confidence: 97, // パーセンテージ
      winner: 'B',
      keyInsights: [
        'より具体的なベネフィットを明示する見出しの方が効果的',
        'アクションを促す強いCTAボタンテキストが反応率を向上',
        '数字を含めることで信頼性が向上（200人以上が実証）',
      ],
      aiSuggestions: [
        'キャリア加速と具体的な成果を強調する表現をさらに強化',
        '「無料カウンセリング」の価値を明確にして不安を取り除く',
        'モバイルユーザー向けにヘッドラインをさらに簡潔に'
      ]
    };
    
    // モックデータ - テストコンポーネント（CTAセクション）
    const mockCtaComponent = {
      id: 'cta',
      name: 'CTAセクション',
      description: '申し込みへの誘導を行うセクション',
      variantA: {
        name: 'ベーシックCTA',
        imgUrl: 'https://images.unsplash.com/photo-1579389083078-4e7018379f7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
        headline: 'マネジメントスキルを磨く一歩を踏み出しませんか？',
        description: '3ヶ月のプログラムで実践的なスキルを習得し、リーダーとしての成長を実現します。',
        visitors: 623,
        conversions: 19,
        conversionRate: 3.05,
        html: `<section class="cta">
          <div class="container">
            <h2>マネジメントスキルを磨く一歩を踏み出しませんか？</h2>
            <p>3ヶ月のプログラムで実践的なスキルを習得し、リーダーとしての成長を実現します。</p>
            <a href="#form" class="button">詳しい資料をダウンロード</a>
          </div>
        </section>`,
        cssClass: 'cta-variant-a',
      },
      variantB: {
        name: '期間限定オファーCTA',
        imgUrl: 'https://images.unsplash.com/photo-1556761175-b413da4baf72?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
        headline: '【期間限定】無料カウンセリング実施中',
        description: '今なら個別相談＋診断シート（通常¥20,000相当）を無料プレゼント！※先着20名様限定',
        visitors: 622,
        conversions: 34,
        conversionRate: 5.47,
        html: `<section class="cta">
          <div class="container">
            <h2>【期間限定】無料カウンセリング実施中</h2>
            <p>今なら個別相談＋診断シート（通常¥20,000相当）を無料プレゼント！※先着20名様限定</p>
            <a href="#form" class="button">今すぐ無料カウンセリングに申し込む</a>
            <span class="deadline">※申込期限：12月31日まで</span>
          </div>
        </section>`,
        cssClass: 'cta-variant-b',
      },
      improvement: 79.3, // パーセンテージ
      confidence: 99, // パーセンテージ
      winner: 'B',
      keyInsights: [
        '希少性（先着20名）と期間限定感が強い反応を生む',
        '具体的な金額表示（¥20,000相当）で価値を明確化',
        '「今すぐ」という言葉が即時行動を促進',
      ],
      aiSuggestions: [
        'カウントダウンタイマーを追加して期間限定感をさらに強化',
        'これまでの参加者の成功事例を具体的な数字と共に紹介',
        '申し込み後の流れを簡潔に説明し不安を取り除く'
      ]
    };
    
    // モックデータ - テストの履歴
    const mockTestHistory = [
      { date: '2023-12-14 10:30', action: 'テスト作成', user: 'Tanaka', icon: 'add_circle' },
      { date: '2023-12-15 09:00', action: 'テスト開始', user: 'Tanaka', icon: 'play_circle' },
      { date: '2023-12-17 15:20', action: 'AI分析実行', user: 'System', icon: 'auto_awesome' },
      { date: '2023-12-19 11:45', action: 'ヒーローセクションの勝者変更: B', user: 'System', icon: 'swap_horiz' },
      { date: '2023-12-20 14:10', action: 'AI最適化提案生成', user: 'System', icon: 'psychology' },
    ];
    
    // モックデータ - 日付ごとのコンバージョン推移
    const mockDailyData = [
      { date: '12/15', visitsA: 89, visitsB: 88, convRateA: 2.2, convRateB: 3.4 },
      { date: '12/16', visitsA: 92, visitsB: 94, convRateA: 3.3, convRateB: 4.3 },
      { date: '12/17', visitsA: 87, visitsB: 85, convRateA: 2.9, convRateB: 5.9 },
      { date: '12/18', visitsA: 95, visitsB: 93, convRateA: 3.2, convRateB: 4.3 },
      { date: '12/19', visitsA: 86, visitsB: 87, convRateA: 3.5, convRateB: 5.7 },
      { date: '12/20', visitsA: 91, visitsB: 90, convRateA: 3.8, convRateB: 5.6 },
      { date: '12/21', visitsA: 83, visitsB: 85, convRateA: 4.8, convRateB: 6.0 },
    ];
    
    // AIインサイトコンポーネント
    const AIInsight = ({ icon, title, description, severity = 'info', action }) => {
      const severityColors = {
        info: '#4299e1',
        success: '#48bb78',
        warning: '#ed8936',
        error: '#f56565'
      };
      
      return (
        <Paper 
          sx={{ 
            p: 2, 
            mb: 2, 
            border: `1px solid ${severityColors[severity]}30`, 
            backgroundColor: `${severityColors[severity]}05` 
          }}
        >
          <Box sx={{ display: 'flex', alignItems: 'flex-start' }}>
            <Avatar 
              sx={{ 
                bgcolor: severityColors[severity], 
                width: 36, 
                height: 36,
                mr: 2
              }}
            >
              <span className="material-icons" style={{ fontSize: 20 }}>{icon}</span>
            </Avatar>
            <Box sx={{ flex: 1 }}>
              <Typography variant="subtitle1" sx={{ fontWeight: 'medium', mb: 0.5 }}>
                {title}
              </Typography>
              <Typography variant="body2" color="textSecondary" sx={{ mb: action ? 1.5 : 0 }}>
                {description}
              </Typography>
              {action}
            </Box>
          </Box>
        </Paper>
      );
    };
    
    // ミニプレビューコンポーネント
    const MiniPreview = ({ variant, component, showFullComparison }) => {
      return (
        <Card sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>
          <Box sx={{ position: 'relative' }}>
            <CardMedia
              component="img"
              height="140"
              image={variant.imgUrl}
              alt={variant.name}
            />
            {component.winner === 'A' && variant === component.variantA && (
              <Chip 
                label="勝者" 
                color="success"
                size="small"
                sx={{ 
                  position: 'absolute', 
                  top: 10, 
                  right: 10,
                  fontWeight: 'bold',
                  className: 'highlight-animation'
                }}
              />
            )}
            {component.winner === 'B' && variant === component.variantB && (
              <Chip 
                label="勝者" 
                color="success"
                size="small"
                sx={{ 
                  position: 'absolute', 
                  top: 10, 
                  right: 10,
                  fontWeight: 'bold',
                  className: 'highlight-animation'
                }}
              />
            )}
          </Box>
          <CardContent sx={{ flexGrow: 1, pb: 1 }}>
            <Typography variant="subtitle1" gutterBottom sx={{ fontWeight: 'medium' }}>
              バリアント{variant === component.variantA ? 'A' : 'B'}: {variant.name}
            </Typography>
            <Typography variant="body2" color="textSecondary" sx={{ mb: 1, height: 40, overflow: 'hidden' }}>
              {variant.headline}
            </Typography>
            
            <Box sx={{ mt: 2 }}>
              <Grid container spacing={1}>
                <Grid item xs={4}>
                  <Typography variant="caption" color="textSecondary" display="block">表示回数</Typography>
                  <Typography variant="subtitle2">{variant.visitors.toLocaleString()}</Typography>
                </Grid>
                <Grid item xs={4}>
                  <Typography variant="caption" color="textSecondary" display="block">CV数</Typography>
                  <Typography variant="subtitle2">{variant.conversions.toLocaleString()}</Typography>
                </Grid>
                <Grid item xs={4}>
                  <Typography variant="caption" color="textSecondary" display="block">CV率</Typography>
                  <Typography 
                    variant="subtitle2" 
                    sx={{ 
                      color: component.winner === (variant === component.variantA ? 'A' : 'B') ? 'success.main' : 'inherit',
                      fontWeight: component.winner === (variant === component.variantA ? 'A' : 'B') ? 'bold' : 'regular'
                    }}
                  >
                    {variant.conversionRate.toFixed(2)}%
                  </Typography>
                </Grid>
              </Grid>
            </Box>
          </CardContent>
          <Box sx={{ px: 2, pb: 2 }}>
            <Button 
              fullWidth 
              variant="outlined" 
              size="small"
              onClick={() => showFullComparison(component.id, variant === component.variantA ? 'A' : 'B')}
              startIcon={<span className="material-icons">visibility</span>}
            >
              プレビュー
            </Button>
          </Box>
        </Card>
      );
    };
    
    // テスト結果分析画面
    const TestAnalysisScreen = () => {
      const [activeTab, setActiveTab] = React.useState(0);
      const [selectedComponent, setSelectedComponent] = React.useState('hero');
      const [comparisonDialogOpen, setComparisonDialogOpen] = React.useState(false);
      const [comparisonData, setComparisonData] = React.useState({ componentId: null, variantId: null });
      const [chartData, setChartData] = React.useState(null);
      
      // チャートデータの初期設定
      React.useEffect(() => {
        // Chart.jsによるグラフ描画
        const ctx = document.getElementById('conversionChart');
        if (ctx) {
          const chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: mockDailyData.map(d => d.date),
              datasets: [
                {
                  label: 'バリアントA CV率',
                  data: mockDailyData.map(d => d.convRateA),
                  borderColor: '#4299e1',
                  backgroundColor: 'rgba(66, 153, 225, 0.1)',
                  tension: 0.4,
                  fill: true,
                  pointBackgroundColor: '#4299e1',
                  pointRadius: 3,
                  pointHoverRadius: 5
                },
                {
                  label: 'バリアントB CV率',
                  data: mockDailyData.map(d => d.convRateB),
                  borderColor: '#48bb78',
                  backgroundColor: 'rgba(72, 187, 120, 0.1)',
                  tension: 0.4,
                  fill: true,
                  pointBackgroundColor: '#48bb78',
                  pointRadius: 3,
                  pointHoverRadius: 5
                }
              ]
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      return `${context.dataset.label}: ${context.raw}%`;
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  title: {
                    display: true,
                    text: 'コンバージョン率 (%)'
                  },
                  ticks: {
                    callback: function(value) {
                      return value + '%';
                    }
                  }
                }
              }
            }
          });
          
          setChartData(chart);
          
          return () => {
            chart.destroy();
          };
        }
      }, []);
      
      // コンポーネントに応じたテストデータを取得
      const getComponentData = (componentId) => {
        switch(componentId) {
          case 'hero':
            return mockHeroComponent;
          case 'cta':
            return mockCtaComponent;
          default:
            return mockHeroComponent;
        }
      };
      
      const currentComponent = getComponentData(selectedComponent);
      
      // プレビュー表示
      const handleShowComparison = (componentId, variantId) => {
        setComparisonData({ componentId, variantId });
        setComparisonDialogOpen(true);
      };
      
      // プレビューダイアログを閉じる
      const handleCloseComparison = () => {
        setComparisonDialogOpen(false);
      };
      
      // テスト終了
      const handleEndTest = () => {
        // ここではモックのためアラートを表示するだけ
        alert('テストを終了しました！');
      };
      
      return (
        <ThemeProvider theme={theme}>
          <CssBaseline />
          
          {/* ヘッダー */}
          <AppBar position="static" color="default" elevation={0} sx={{ backgroundColor: 'white', borderBottom: '1px solid #e2e8f0' }}>
            <Toolbar>
              <IconButton edge="start" color="inherit" aria-label="back" sx={{ mr: 1 }}>
                <span className="material-icons">arrow_back</span>
              </IconButton>
              <Typography variant="h6" component="div" sx={{ flexGrow: 1 }}>
                テスト結果分析: {mockTestInfo.name}
              </Typography>
              <Button 
                variant="outlined" 
                color="primary" 
                startIcon={<span className="material-icons">stop</span>}
                sx={{ mr: 1 }}
                onClick={handleEndTest}
              >
                テスト終了
              </Button>
              <Button 
                variant="contained" 
                color="primary" 
                startIcon={<span className="material-icons">auto_fix_high</span>}
              >
                AIで最適化
              </Button>
            </Toolbar>
          </AppBar>
          
          {/* メインコンテンツ */}
          <Container maxWidth="lg" sx={{ mt: 4, mb: 4 }}>
            {/* テスト概要カード */}
            <Paper sx={{ p: 3, mb: 4 }} className="fade-in">
              <Grid container spacing={2}>
                <Grid item xs={12} md={8}>
                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                    <Typography variant="h5" sx={{ mr: 2 }}>
                      {mockTestInfo.lpName}
                    </Typography>
                    <Chip 
                      label={
                        mockTestInfo.status === 'running' ? '実行中' : 
                        mockTestInfo.status === 'completed' ? '完了' : '一時停止'
                      } 
                      color={
                        mockTestInfo.status === 'running' ? 'success' : 
                        mockTestInfo.status === 'completed' ? 'primary' : 'warning'
                      }
                      size="small"
                    />
                  </Box>
                  
                  <Typography variant="body2" color="textSecondary" paragraph>
                    テスト期間: {mockTestInfo.startDate} 〜 {mockTestInfo.endDate}（{Math.round((new Date(mockTestInfo.endDate) - new Date(mockTestInfo.startDate)) / (1000 * 60 * 60 * 24))}日間）
                  </Typography>
                  
                  <Box sx={{ mb: 2 }}>
                    <Typography variant="caption" color="textSecondary" sx={{ mb: 0.5, display: 'block' }}>
                      テスト進捗: {mockTestInfo.progress}%
                    </Typography>
                    <LinearProgress 
                      variant="determinate" 
                      value={mockTestInfo.progress} 
                      sx={{ 
                        height: 8, 
                        borderRadius: 4,
                        backgroundColor: '#e2e8f0',
                        '& .MuiLinearProgress-bar': {
                          borderRadius: 4,
                        }
                      }}
                    />
                  </Box>
                  
                  <Typography variant="body2" color="textSecondary">
                    コンバージョン目標: {
                      mockTestInfo.conversionGoal === 'form_submit' ? 'フォーム送信' : 
                      mockTestInfo.conversionGoal === 'button_click' ? 'ボタンクリック' : 
                      'その他のアクション'
                    }
                  </Typography>
                </Grid>
                
                <Grid item xs={12} md={4}>
                  <Box sx={{ display: 'flex', justifyContent: 'space-between', flexWrap: 'wrap', height: '100%' }}>
                    <Box sx={{ minWidth: '33%', mb: 2 }}>
                      <Typography variant="caption" color="textSecondary" display="block">総訪問者数</Typography>
                      <Typography variant="h6">{mockTestInfo.totalVisitors.toLocaleString()}</Typography>
                    </Box>
                    
                    <Box sx={{ minWidth: '33%', mb: 2 }}>
                      <Typography variant="caption" color="textSecondary" display="block">総CV数</Typography>
                      <Typography variant="h6">{mockTestInfo.totalConversions.toLocaleString()}</Typography>
                    </Box>
                    
                    <Box sx={{ minWidth: '33%', mb: 2 }}>
                      <Typography variant="caption" color="textSecondary" display="block">平均CV率</Typography>
                      <Typography variant="h6">{mockTestInfo.overallConversionRate.toFixed(2)}%</Typography>
                    </Box>
                    
                    <Box sx={{ width: '100%' }}>
                      <Button 
                        variant="outlined" 
                        color="primary" 
                        fullWidth
                        startIcon={<span className="material-icons">insert_chart</span>}
                        sx={{ mt: 1 }}
                      >
                        詳細レポートをダウンロード
                      </Button>
                    </Box>
                  </Box>
                </Grid>
              </Grid>
            </Paper>
            
            {/* タブナビゲーション */}
            <Box sx={{ mb: 4 }}>
              <Tabs 
                value={activeTab} 
                onChange={(e, val) => setActiveTab(val)}
                variant="scrollable"
                scrollButtons="auto"
                sx={{ 
                  borderBottom: 1, 
                  borderColor: 'divider',
                  '.MuiTab-root': { 
                    textTransform: 'none',
                    fontSize: '0.95rem'
                  }
                }}
              >
                <Tab icon={<span className="material-icons">dashboard</span>} label="概要" iconPosition="start" />
                <Tab icon={<span className="material-icons">science</span>} label="コンポーネント分析" iconPosition="start" />
                <Tab icon={<span className="material-icons">psychology</span>} label="AI分析・提案" iconPosition="start" />
                <Tab icon={<span className="material-icons">history</span>} label="履歴" iconPosition="start" />
              </Tabs>
            </Box>
            
            {/* タブコンテンツ */}
            <Box className="fade-in" sx={{ display: activeTab === 0 ? 'block' : 'none' }}>
              {/* 概要タブ */}
              <Grid container spacing={4}>
                {/* コンバージョン率の推移グラフ */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>コンバージョン率の推移</Typography>
                    <Box sx={{ height: 300 }}>
                      <canvas id="conversionChart"></canvas>
                    </Box>
                  </Paper>
                </Grid>
                
                {/* コンポーネント別サマリー */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>テスト対象コンポーネント</Typography>
                    <Typography variant="body2" color="textSecondary" paragraph>
                      各コンポーネントのパフォーマンスサマリーです。詳細な分析は「コンポーネント分析」タブから確認できます。
                    </Typography>
                    
                    <TableContainer>
                      <Table>
                        <TableHead>
                          <TableRow>
                            <TableCell>コンポーネント</TableCell>
                            <TableCell align="center">バリアントA (CV率)</TableCell>
                            <TableCell align="center">バリアントB (CV率)</TableCell>
                            <TableCell align="center">改善率</TableCell>
                            <TableCell align="center">信頼度</TableCell>
                            <TableCell align="center">勝者</TableCell>
                          </TableRow>
                        </TableHead>
                        <TableBody>
                          <TableRow>
                            <TableCell component="th" scope="row">
                              {mockHeroComponent.name}
                            </TableCell>
                            <TableCell align="center">{mockHeroComponent.variantA.conversionRate.toFixed(2)}%</TableCell>
                            <TableCell align="center">{mockHeroComponent.variantB.conversionRate.toFixed(2)}%</TableCell>
                            <TableCell align="center">
                              <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 16, marginRight: 4 }}>
                                  arrow_upward
                                </span>
                                {mockHeroComponent.improvement.toFixed(1)}%
                              </Box>
                            </TableCell>
                            <TableCell align="center">
                              <Tooltip title="信頼度とは、結果が偶然ではなく実際の効果による確率を示します">
                                <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                                  {mockHeroComponent.confidence}%
                                  {mockHeroComponent.confidence >= 95 && (
                                    <span className="material-icons" style={{ color: '#48bb78', fontSize: 16, marginLeft: 4 }}>
                                      check_circle
                                    </span>
                                  )}
                                </Box>
                              </Tooltip>
                            </TableCell>
                            <TableCell align="center">
                              <Chip 
                                label={`バリアント${mockHeroComponent.winner}`} 
                                color="success"
                                size="small"
                                sx={{ fontWeight: 'bold' }}
                              />
                            </TableCell>
                          </TableRow>
                          <TableRow>
                            <TableCell component="th" scope="row">
                              {mockCtaComponent.name}
                            </TableCell>
                            <TableCell align="center">{mockCtaComponent.variantA.conversionRate.toFixed(2)}%</TableCell>
                            <TableCell align="center">{mockCtaComponent.variantB.conversionRate.toFixed(2)}%</TableCell>
                            <TableCell align="center">
                              <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 16, marginRight: 4 }}>
                                  arrow_upward
                                </span>
                                {mockCtaComponent.improvement.toFixed(1)}%
                              </Box>
                            </TableCell>
                            <TableCell align="center">
                              <Tooltip title="信頼度とは、結果が偶然ではなく実際の効果による確率を示します">
                                <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                                  {mockCtaComponent.confidence}%
                                  {mockCtaComponent.confidence >= 95 && (
                                    <span className="material-icons" style={{ color: '#48bb78', fontSize: 16, marginLeft: 4 }}>
                                      check_circle
                                    </span>
                                  )}
                                </Box>
                              </Tooltip>
                            </TableCell>
                            <TableCell align="center">
                              <Chip 
                                label={`バリアント${mockCtaComponent.winner}`} 
                                color="success"
                                size="small"
                                sx={{ fontWeight: 'bold' }}
                              />
                            </TableCell>
                          </TableRow>
                        </TableBody>
                      </Table>
                    </TableContainer>
                  </Paper>
                </Grid>
                
                {/* AIサマリーインサイト */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>AIによる分析サマリー</Typography>
                    <Typography variant="body2" color="textSecondary" paragraph>
                      AIが分析した主要なインサイトと改善提案です。詳細な分析結果は「AI分析・提案」タブをご覧ください。
                    </Typography>
                    
                    <AIInsight
                      icon="auto_awesome"
                      title="効果的なシグナル: 期間限定・希少性の強調"
                      description="CTAセクションで約80%の改善を達成したバリアントBでは「期間限定」「先着20名様限定」などの希少性と緊急性を表すフレーズが大きく貢献しています。他のセクションでもこの手法の活用を検討すると良いでしょう。"
                      severity="success"
                    />
                    
                    <AIInsight
                      icon="trending_up"
                      title="ユーザー行動の変化: 具体的な価値提示への反応"
                      description="両コンポーネントで勝者となったバリアントは、抽象的な表現よりも具体的な価値（「20,000円相当」「200人以上が実証」など）を示している点が共通しています。ユーザーは具体的なベネフィットに強く反応する傾向があります。"
                      severity="info"
                    />
                    
                    <AIInsight
                      icon="priority_high"
                      title="注目ポイント: モバイルユーザーとデスクトップユーザーの差"
                      description="ヒーローセクションではモバイルユーザーのコンバージョン率がデスクトップユーザーより低い傾向があります。ヘッドラインをモバイルでより簡潔に表示するなどの最適化を検討してください。"
                      severity="warning"
                      action={
                        <Button 
                          variant="outlined" 
                          size="small" 
                          startIcon={<span className="material-icons">devices</span>}
                        >
                          デバイス別データを見る
                        </Button>
                      }
                    />
                  </Paper>
                </Grid>
              </Grid>
            </Box>
            
            <Box className="fade-in" sx={{ display: activeTab === 1 ? 'block' : 'none' }}>
              {/* コンポーネント分析タブ */}
              <Grid container spacing={4}>
                {/* コンポーネント選択 */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="subtitle1" gutterBottom>コンポーネントを選択</Typography>
                    <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>
                      <Button 
                        variant={selectedComponent === 'hero' ? 'contained' : 'outlined'}
                        onClick={() => setSelectedComponent('hero')}
                        size="medium"
                        sx={{ borderRadius: 4, px: 2 }}
                      >
                        ヒーローセクション
                      </Button>
                      <Button 
                        variant={selectedComponent === 'cta' ? 'contained' : 'outlined'}
                        onClick={() => setSelectedComponent('cta')}
                        size="medium"
                        sx={{ borderRadius: 4, px: 2 }}
                      >
                        CTAセクション
                      </Button>
                    </Box>
                  </Paper>
                </Grid>
                
                {/* バリアント比較 */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>
                      <Typography variant="h6">{currentComponent.name}の比較</Typography>
                      <Button 
                        variant="outlined" 
                        size="small"
                        startIcon={<span className="material-icons">compare</span>}
                        onClick={() => handleShowComparison(currentComponent.id, 'compare')}
                      >
                        全体を比較表示
                      </Button>
                    </Box>
                    
                    <Grid container spacing={3}>
                      <Grid item xs={12} md={6}>
                        <MiniPreview 
                          variant={currentComponent.variantA} 
                          component={currentComponent}
                          showFullComparison={handleShowComparison}
                        />
                      </Grid>
                      <Grid item xs={12} md={6}>
                        <MiniPreview 
                          variant={currentComponent.variantB} 
                          component={currentComponent}
                          showFullComparison={handleShowComparison}
                        />
                      </Grid>
                    </Grid>
                    
                    <Box sx={{ mt: 3, p: 2, bgcolor: '#f8fafc', borderRadius: 2 }}>
                      <Typography variant="subtitle1" gutterBottom>
                        <Box component="span" sx={{ display: 'inline-flex', alignItems: 'center' }}>
                          <span className="material-icons" style={{ fontSize: 20, marginRight: 8, color: '#4299e1' }}>
                            trending_up
                          </span>
                          パフォーマンス比較
                        </Box>
                      </Typography>
                      
                      <Grid container spacing={2} sx={{ mb: 2 }}>
                        <Grid item xs={12} sm={4}>
                          <Paper sx={{ p: 2, height: '100%' }}>
                            <Typography variant="caption" color="textSecondary" display="block">コンバージョン率向上</Typography>
                            <Box sx={{ display: 'flex', alignItems: 'baseline' }}>
                              <Typography variant="h4" color="success.main" sx={{ fontWeight: 'bold' }}>
                                {currentComponent.improvement.toFixed(1)}%
                              </Typography>
                              <Typography variant="body2" color="textSecondary" sx={{ ml: 1 }}>
                                改善
                              </Typography>
                            </Box>
                          </Paper>
                        </Grid>
                        
                        <Grid item xs={12} sm={4}>
                          <Paper sx={{ p: 2, height: '100%' }}>
                            <Typography variant="caption" color="textSecondary" display="block">統計的信頼度</Typography>
                            <Box sx={{ display: 'flex', alignItems: 'center' }}>
                              <Typography variant="h4" sx={{ 
                                fontWeight: 'bold',
                                color: currentComponent.confidence >= 95 ? 'success.main' : 
                                       currentComponent.confidence >= 80 ? 'warning.main' : 'text.primary'
                              }}>
                                {currentComponent.confidence}%
                              </Typography>
                              {currentComponent.confidence >= 95 && (
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 24, marginLeft: 8 }}>
                                  verified
                                </span>
                              )}
                            </Box>
                          </Paper>
                        </Grid>
                        
                        <Grid item xs={12} sm={4}>
                          <Paper sx={{ p: 2, height: '100%' }}>
                            <Typography variant="caption" color="textSecondary" display="block">勝者バリアント</Typography>
                            <Typography variant="h4" color="success.main" sx={{ fontWeight: 'bold' }}>
                              バリアント{currentComponent.winner}
                            </Typography>
                          </Paper>
                        </Grid>
                      </Grid>
                      
                      <Typography variant="subtitle1" gutterBottom>
                        <Box component="span" sx={{ display: 'inline-flex', alignItems: 'center' }}>
                          <span className="material-icons" style={{ fontSize: 20, marginRight: 8, color: '#4299e1' }}>
                            psychology
                          </span>
                          AIによる主要インサイト
                        </Box>
                      </Typography>
                      
                      <List dense>
                        {currentComponent.keyInsights.map((insight, idx) => (
                          <ListItem key={idx}>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary={insight} 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                        ))}
                      </List>
                    </Box>
                  </Paper>
                </Grid>
                
                {/* ユーザー行動詳細 */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>ユーザー行動の詳細</Typography>
                    
                    <Box sx={{ mb: 3 }}>
                      <Grid container spacing={2}>
                        <Grid item xs={12} md={6}>
                          <Paper variant="outlined" sx={{ p: 2 }}>
                            <Typography variant="subtitle2" gutterBottom>
                              バリアントAでの行動パターン
                            </Typography>
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                滞在時間
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#4299e1', fontSize: 20, marginRight: 8 }}>
                                  timer
                                </span>
                                <Typography variant="body2">
                                  平均 <strong>42秒</strong>
                                </Typography>
                              </Box>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                スクロール深度
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#4299e1', fontSize: 20, marginRight: 8 }}>
                                  height
                                </span>
                                <Typography variant="body2">
                                  平均ページの <strong>68%</strong> までスクロール
                                </Typography>
                              </Box>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                クリック率
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#4299e1', fontSize: 20, marginRight: 8 }}>
                                  touch_app
                                </span>
                                <Typography variant="body2">
                                  CTAボタンクリック率: <strong>7.2%</strong>
                                </Typography>
                              </Box>
                            </Box>
                          </Paper>
                        </Grid>
                        
                        <Grid item xs={12} md={6}>
                          <Paper variant="outlined" sx={{ p: 2 }}>
                            <Typography variant="subtitle2" gutterBottom>
                              バリアントBでの行動パターン
                            </Typography>
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                滞在時間
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 20, marginRight: 8 }}>
                                  timer
                                </span>
                                <Typography variant="body2">
                                  平均 <strong>56秒</strong> <span style={{ color: '#48bb78' }}>(+33.3%)</span>
                                </Typography>
                              </Box>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                スクロール深度
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 20, marginRight: 8 }}>
                                  height
                                </span>
                                <Typography variant="body2">
                                  平均ページの <strong>82%</strong> までスクロール <span style={{ color: '#48bb78' }}>(+20.6%)</span>
                                </Typography>
                              </Box>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Typography variant="caption" display="block" gutterBottom>
                                クリック率
                              </Typography>
                              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                                <span className="material-icons" style={{ color: '#48bb78', fontSize: 20, marginRight: 8 }}>
                                  touch_app
                                </span>
                                <Typography variant="body2">
                                  CTAボタンクリック率: <strong>12.5%</strong> <span style={{ color: '#48bb78' }}>(+73.6%)</span>
                                </Typography>
                              </Box>
                            </Box>
                          </Paper>
                        </Grid>
                      </Grid>
                    </Box>
                    
                    <Button 
                      variant="outlined" 
                      startIcon={<span className="material-icons">analytics</span>}
                      fullWidth
                    >
                      詳細なユーザー行動分析を表示
                    </Button>
                  </Paper>
                </Grid>
              </Grid>
            </Box>
            
            <Box className="fade-in" sx={{ display: activeTab === 2 ? 'block' : 'none' }}>
              {/* AI分析・提案タブ */}
              <Grid container spacing={4}>
                {/* AI総合分析 */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>AI総合分析</Typography>
                    <Typography variant="body2" color="textSecondary" paragraph>
                      AIが複数のコンポーネントのテスト結果を分析し、全体的なパターンと改善点を特定しました。
                    </Typography>
                    
                    <Paper variant="outlined" sx={{ p: 3, bgcolor: '#f8fafc' }}>
                      <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>
                        <Avatar sx={{ bgcolor: 'primary.main', mr: 2 }}>
                          <span className="material-icons">psychology</span>
                        </Avatar>
                        <Typography variant="h6">AIによる主要な発見</Typography>
                      </Box>
                      
                      <Divider sx={{ my: 2 }} />
                      
                      <Box sx={{ mb: 3 }}>
                        <Typography variant="subtitle1" gutterBottom>
                          1. コミュニケーションスタイルの効果
                        </Typography>
                        <Typography variant="body2" paragraph>
                          バリアントBでは全体的に「より直接的で具体的な表現」が使われており、これが高いコンバージョン率に繋がっています。特に以下の要素が効果的でした：
                        </Typography>
                        <List dense>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="具体的な数字による信頼性の向上（「200人以上が実証」「20,000円相当」）" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="行動を促す強いCTAテキスト（「無料カウンセリングに申し込む」vs「詳細を見る」）" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="希少性と緊急性の強調（「期間限定」「先着20名様限定」）" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                        </List>
                      </Box>
                      
                      <Box sx={{ mb: 3 }}>
                        <Typography variant="subtitle1" gutterBottom>
                          2. ビジュアル要素とレイアウトの影響
                        </Typography>
                        <Typography variant="body2" paragraph>
                          バリアントBでは視覚的な階層と強調がより明確になっています：
                        </Typography>
                        <List dense>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="より大きなコントラストと色の使い分け（特にCTAボタンの色が目立つ）" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="視線誘導のための空間的な配置（重要な要素により多くのスペースを割り当て）" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                        </List>
                      </Box>
                      
                      <Box>
                        <Typography variant="subtitle1" gutterBottom>
                          3. ターゲットオーディエンスの反応パターン
                        </Typography>
                        <Typography variant="body2" paragraph>
                          ユーザーセグメント別に異なる反応が見られました：
                        </Typography>
                        <List dense>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="モバイルユーザーはより簡潔なメッセージと大きなCTAボタンに反応" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="リピートユーザーは期間限定オファーと数値的な証拠に強く反応" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                          <ListItem>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#48bb78' }}>
                                check_circle
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary="直接流入ユーザーは無料オファーに最も高い反応率" 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                        </List>
                      </Box>
                    </Paper>
                  </Paper>
                </Grid>
                
                {/* 最適化提案 */}
                <Grid item xs={12}>
                  <Paper sx={{ p: 3 }} className="slide-in-up">
                    <Typography variant="h6" gutterBottom>AIによる最適化提案</Typography>
                    <Typography variant="body2" color="textSecondary" paragraph>
                      テスト結果に基づいた具体的な改善提案です。これらを実装することで、さらにコンバージョン率を向上させることができます。
                    </Typography>
                    
                    <Grid container spacing={3}>
                      <Grid item xs={12} md={6}>
                        <Card sx={{ height: '100%' }}>
                          <Box sx={{ p: 2, bgcolor: 'primary.main', color: 'white' }}>
                            <Typography variant="subtitle1" sx={{ fontWeight: 'medium' }}>
                              ヒーローセクションの最適化
                            </Typography>
                          </Box>
                          <CardContent>
                            <List dense>
                              {mockHeroComponent.aiSuggestions.map((suggestion, idx) => (
                                <ListItem key={idx} sx={{ px: 0, py: 0.5 }}>
                                  <ListItemIcon sx={{ minWidth: 28 }}>
                                    <span className="material-icons" style={{ fontSize: 16, color: '#4299e1' }}>
                                      lightbulb
                                    </span>
                                  </ListItemIcon>
                                  <ListItemText 
                                    primary={suggestion} 
                                    primaryTypographyProps={{ variant: 'body2' }}
                                  />
                                </ListItem>
                              ))}
                            </List>
                            
                            <Divider sx={{ my: 2 }} />
                            
                            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                              <Typography variant="caption" color="textSecondary">
                                予測改善率
                              </Typography>
                              <Typography variant="subtitle2" color="success.main">
                                +10〜15%
                              </Typography>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Button 
                                fullWidth 
                                variant="outlined" 
                                color="primary"
                                size="small"
                                startIcon={<span className="material-icons">auto_fix_high</span>}
                              >
                                AIで自動最適化
                              </Button>
                            </Box>
                          </CardContent>
                        </Card>
                      </Grid>
                      
                      <Grid item xs={12} md={6}>
                        <Card sx={{ height: '100%' }}>
                          <Box sx={{ p: 2, bgcolor: 'primary.main', color: 'white' }}>
                            <Typography variant="subtitle1" sx={{ fontWeight: 'medium' }}>
                              CTAセクションの最適化
                            </Typography>
                          </Box>
                          <CardContent>
                            <List dense>
                              {mockCtaComponent.aiSuggestions.map((suggestion, idx) => (
                                <ListItem key={idx} sx={{ px: 0, py: 0.5 }}>
                                  <ListItemIcon sx={{ minWidth: 28 }}>
                                    <span className="material-icons" style={{ fontSize: 16, color: '#4299e1' }}>
                                      lightbulb
                                    </span>
                                  </ListItemIcon>
                                  <ListItemText 
                                    primary={suggestion} 
                                    primaryTypographyProps={{ variant: 'body2' }}
                                  />
                                </ListItem>
                              ))}
                            </List>
                            
                            <Divider sx={{ my: 2 }} />
                            
                            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                              <Typography variant="caption" color="textSecondary">
                                予測改善率
                              </Typography>
                              <Typography variant="subtitle2" color="success.main">
                                +15〜20%
                              </Typography>
                            </Box>
                            
                            <Box sx={{ mt: 2 }}>
                              <Button 
                                fullWidth 
                                variant="outlined" 
                                color="primary"
                                size="small"
                                startIcon={<span className="material-icons">auto_fix_high</span>}
                              >
                                AIで自動最適化
                              </Button>
                            </Box>
                          </CardContent>
                        </Card>
                      </Grid>
                      
                      <Grid item xs={12}>
                        <Card>
                          <Box sx={{ p: 2, bgcolor: 'secondary.main', color: 'white' }}>
                            <Typography variant="subtitle1" sx={{ fontWeight: 'medium' }}>
                              次のステップの提案
                            </Typography>
                          </Box>
                          <CardContent>
                            <Box sx={{ display: 'flex', flexDirection: { xs: 'column', md: 'row' }, gap: 2 }}>
                              <Paper variant="outlined" sx={{ flex: 1, p: 2 }}>
                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                                  <Avatar sx={{ bgcolor: 'secondary.light', width: 32, height: 32, mr: 1 }}>1</Avatar>
                                  <Typography variant="subtitle2">勝者バリアントの適用</Typography>
                                </Box>
                                <Typography variant="body2" color="textSecondary">
                                  テストで判明した勝者バリアントを本番環境に適用し、即時の改善を実現しましょう。
                                </Typography>
                                <Button 
                                  variant="contained" 
                                  color="primary"
                                  size="small"
                                  fullWidth
                                  sx={{ mt: 2 }}
                                  startIcon={<span className="material-icons">check_circle</span>}
                                >
                                  勝者を適用
                                </Button>
                              </Paper>
                              
                              <Paper variant="outlined" sx={{ flex: 1, p: 2 }}>
                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                                  <Avatar sx={{ bgcolor: 'secondary.light', width: 32, height: 32, mr: 1 }}>2</Avatar>
                                  <Typography variant="subtitle2">新テストの計画</Typography>
                                </Box>
                                <Typography variant="body2" color="textSecondary">
                                  AIの提案を取り入れた新たなバリアントでフォローアップテストを計画しましょう。
                                </Typography>
                                <Button 
                                  variant="outlined" 
                                  color="secondary"
                                  size="small"
                                  fullWidth
                                  sx={{ mt: 2 }}
                                  startIcon={<span className="material-icons">science</span>}
                                >
                                  新テスト作成
                                </Button>
                              </Paper>
                              
                              <Paper variant="outlined" sx={{ flex: 1, p: 2 }}>
                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                                  <Avatar sx={{ bgcolor: 'secondary.light', width: 32, height: 32, mr: 1 }}>3</Avatar>
                                  <Typography variant="subtitle2">他コンポーネントへの応用</Typography>
                                </Box>
                                <Typography variant="body2" color="textSecondary">
                                  発見されたパターンを他のコンポーネントにも応用して、さらなる改善を図りましょう。
                                </Typography>
                                <Button 
                                  variant="outlined" 
                                  color="secondary"
                                  size="small"
                                  fullWidth
                                  sx={{ mt: 2 }}
                                  startIcon={<span className="material-icons">share</span>}
                                >
                                  パターン適用
                                </Button>
                              </Paper>
                            </Box>
                          </CardContent>
                        </Card>
                      </Grid>
                    </Grid>
                  </Paper>
                </Grid>
              </Grid>
            </Box>
            
            <Box className="fade-in" sx={{ display: activeTab === 3 ? 'block' : 'none' }}>
              {/* 履歴タブ */}
              <Paper sx={{ p: 3 }} className="slide-in-up">
                <Typography variant="h6" gutterBottom>テスト履歴</Typography>
                <Typography variant="body2" color="textSecondary" paragraph>
                  このテストのすべてのアクションとイベントの履歴を時系列で表示しています。
                </Typography>
                
                <List>
                  {mockTestHistory.map((item, idx) => (
                    <React.Fragment key={idx}>
                      <ListItem sx={{ py: 2 }}>
                        <ListItemAvatar>
                          <Avatar sx={{ bgcolor: item.user === 'System' ? 'primary.main' : 'secondary.main' }}>
                            <span className="material-icons">{item.icon}</span>
                          </Avatar>
                        </ListItemAvatar>
                        <ListItemText 
                          primary={item.action}
                          secondary={`${item.date} - ${item.user}`}
                        />
                      </ListItem>
                      {idx < mockTestHistory.length - 1 && <Divider variant="inset" component="li" />}
                    </React.Fragment>
                  ))}
                </List>
              </Paper>
            </Box>
          </Container>
          
          {/* プレビュー比較ダイアログ */}
          <Dialog
            open={comparisonDialogOpen}
            onClose={handleCloseComparison}
            maxWidth="lg"
            fullWidth
          >
            <DialogTitle>
              {comparisonData.componentId === 'hero' ? 'ヒーローセクション' : 'CTAセクション'}の
              {comparisonData.variantId === 'compare' ? '比較' : `バリアント${comparisonData.variantId}表示`}
            </DialogTitle>
            <DialogContent>
              {comparisonData.variantId === 'compare' ? (
                <Grid container spacing={2}>
                  <Grid item xs={12} md={6}>
                    <Box sx={{ height: 400 }}>
                      <Typography variant="subtitle1" align="center" gutterBottom>バリアントA</Typography>
                      <iframe
                        className="variant-preview-iframe"
                        title="Variant A Preview"
                        srcDoc={comparisonData.componentId === 'hero' ? 
                          mockHeroComponent.variantA.html : mockCtaComponent.variantA.html}
                        style={{ height: '350px' }}
                      />
                    </Box>
                  </Grid>
                  <Grid item xs={12} md={6}>
                    <Box sx={{ height: 400 }}>
                      <Typography variant="subtitle1" align="center" gutterBottom>バリアントB</Typography>
                      <iframe
                        className="variant-preview-iframe"
                        title="Variant B Preview"
                        srcDoc={comparisonData.componentId === 'hero' ? 
                          mockHeroComponent.variantB.html : mockCtaComponent.variantB.html}
                        style={{ height: '350px' }}
                      />
                    </Box>
                  </Grid>
                  <Grid item xs={12}>
                    <Paper sx={{ p: 2, bgcolor: '#f8fafc' }}>
                      <Typography variant="subtitle1" gutterBottom>主な違い</Typography>
                      <List dense>
                        {(comparisonData.componentId === 'hero' ? 
                          mockHeroComponent.keyInsights : mockCtaComponent.keyInsights).map((insight, idx) => (
                          <ListItem key={idx}>
                            <ListItemIcon sx={{ minWidth: 28 }}>
                              <span className="material-icons" style={{ fontSize: 16, color: '#4299e1' }}>
                                arrow_right
                              </span>
                            </ListItemIcon>
                            <ListItemText 
                              primary={insight} 
                              primaryTypographyProps={{ variant: 'body2' }}
                            />
                          </ListItem>
                        ))}
                      </List>
                    </Paper>
                  </Grid>
                </Grid>
              ) : (
                <Box sx={{ height: 500 }}>
                  <iframe
                    className="variant-preview-iframe"
                    title="Variant Preview"
                    srcDoc={
                      comparisonData.componentId === 'hero' ? 
                        (comparisonData.variantId === 'A' ? mockHeroComponent.variantA.html : mockHeroComponent.variantB.html) : 
                        (comparisonData.variantId === 'A' ? mockCtaComponent.variantA.html : mockCtaComponent.variantB.html)
                    }
                    style={{ height: '100%' }}
                  />
                </Box>
              )}
            </DialogContent>
            <DialogActions>
              <Button onClick={handleCloseComparison}>閉じる</Button>
            </DialogActions>
          </Dialog>
        </ThemeProvider>
      );
    };
    
    // アプリケーションのメインコンポーネント
    const App = () => {
      return (
        <ErrorBoundary>
          <TestAnalysisScreen />
        </ErrorBoundary>
      );
    };
    
    // Reactをレンダリング
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
