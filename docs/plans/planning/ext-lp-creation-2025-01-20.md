# 機能拡張計画: LP作成機能 2025-01-20

## 1. 拡張概要

既存のプロジェクト管理システムに、URLから対象ページのレプリカを作成し、それを自社仕様のLPに変換するための機能を追加します。この機能により、非技術者でも効率的にLPを作成・カスタマイズできるようになり、精密差し替えエージェントとの連携で高品質なLP制作が可能になります。

## 2. 詳細仕様

### 2.1 現状と課題

現在、LPを作成する際には以下の課題があります：
- ゼロからコーディングする必要があり時間がかかる
- 参考サイトの要素を再現するのが困難
- 変更箇所をAIに伝える際、スクリーンショットなどでの認識合わせが煩雑

### 2.2 拡張内容

1. **レプリカ作成機能**
   - URLを入力してWebサイトの完全なローカルレプリカを作成
   - HTMLとすべてのアセット（CSS、画像、JS）をプロジェクト内に保存
   - Pythonスクリプト（website_replicator.py）を活用

2. **レプリカビューア機能**
   - VSCodeのスコープマネージャーに新しいタブ「LPレプリカ」を追加
   - プロジェクト内のレプリカをWebviewで表示
   - 要素クリックで詳細情報を取得・コピー可能

3. **要素選択支援機能**
   - 表示されたレプリカ内の要素をクリック
   - 要素のパス、HTML、スタイル情報を精密差し替えエージェント向けにフォーマット
   - ワンクリックでクリップボードにコピー

### 3. ディレクトリ構造

```
プロジェクトフォルダ/
├── docs/
├── requirements/
├── mockups/
├── replica/                    # 新規追加
│   ├── index.html             # レプリカのメインHTML
│   ├── css/                   # CSSファイル
│   ├── js/                    # JavaScriptファイル
│   ├── images/                # 画像ファイル
│   ├── fonts/                 # フォントファイル
│   └── resources.json         # リソース一覧
└── SCOPE_PROGRESS.md

VSCode拡張機能/
├── src/
│   ├── services/
│   │   └── ReplicaService.ts  # 新規追加
│   └── ui/
│       └── scopeManager/
│           └── components/
│               └── lpReplica/ # 新規追加
└── scripts/
    └── website_replicator.py  # Pythonスクリプトを配置
```

## 4. 技術的影響分析

### 4.1 影響範囲

- **フロントエンド（VSCode拡張）**: スコープマネージャーに新タブ追加、Webview実装
- **バックエンド**: レプリカ作成APIの追加（オプション）
- **データモデル**: プロジェクトモデルにレプリカ情報を追加
- **その他**: Python実行環境の依存

### 4.2 変更が必要なファイル

```
[VSCode拡張機能]
- /src/ui/scopeManager/templates/ScopeManagerTemplate.ts: 新しいタブ追加
- /src/ui/scopeManager/ScopeManagerPanel.ts: レプリカ関連のメッセージハンドリング追加
- /media/scopeManager.js: レプリカビューアのJavaScript追加
- /media/scopeManager.css: レプリカビューアのスタイル追加

[新規作成]
- /src/services/ReplicaService.ts: レプリカ作成・管理サービス
- /src/ui/scopeManager/components/lpReplica/lpReplicaComponent.ts: UIコンポーネント
- /scripts/website_replicator.py: Pythonスクリプトの配置

[共有定義]
- /shared/index.ts: レプリカ関連の型定義追加
```

## 5. タスクリスト

```
- [ ] **T1**: Pythonスクリプトの統合準備（scripts/フォルダに配置、動作確認）
- [ ] **T2**: ReplicaServiceの実装（Python実行、結果の処理）
- [ ] **T3**: スコープマネージャーに「LPレプリカ」タブを追加
- [ ] **T4**: レプリカ作成UIの実装（URL入力、実行ボタン）
- [ ] **T5**: レプリカビューアの実装（Webviewでindex.html表示）
- [ ] **T6**: 要素クリック機能の実装（JavaScript注入、情報取得）
- [ ] **T7**: クリップボードコピー機能の実装（フォーマット処理）
- [ ] **T8**: エラーハンドリングとローディング状態の実装
- [ ] **T9**: テストとドキュメント作成
```

### 6. テスト計画

1. **機能テスト**
   - 様々なURLでレプリカ作成が成功するか
   - 作成されたレプリカが正しく表示されるか
   - 要素クリックで適切な情報が取得できるか

2. **統合テスト**
   - プロジェクト作成→レプリカ作成→表示の一連の流れ
   - 精密差し替えエージェントとの連携確認

3. **パフォーマンステスト**
   - 大きなサイトのレプリカ作成時間
   - Webview表示のレスポンス

## 7. SCOPE_PROGRESSへの統合

以下の内容をSCOPE_PROGRESS.mdに追加：

```markdown
- [ ] **LP-001**: LP作成機能の実装
  - 目標: 2025-01-25
  - 参照: [/docs/plans/planning/ext-lp-creation-2025-01-20.md]
  - 内容: URLからレプリカを作成し、要素選択支援でLP制作を効率化
```

## 8. 備考

- 将来的にはLPレプリカ専門ツールとして独立させる予定
- 現段階では既存システムを活用し、段階的に機能を充実させる
- Python3環境が必要なため、インストールガイドを準備する必要がある
- セキュリティ面で外部URLへのアクセス制限を検討する必要がある