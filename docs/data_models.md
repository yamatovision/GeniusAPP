# データモデル定義

このファイルはプロジェクト全体のデータモデル定義を一元管理する「単一の真実源」です。
データモデルの変更は必ずこのファイルに反映し、他の場所でデータモデルを定義することは避けてください。

## データモデル管理原則

### 重要な原則
1. このファイルが唯一のデータモデル定義源です
2. 初期データモデルはスコープマネージャーが設計します
3. スコープ実装アシスタントは実装時に必要に応じてモデルを拡張・詳細化できます
4. データモデルを変更する際は必ずこのファイルを更新し、変更履歴を記録してください
5. 大規模な構造変更は事前に他のスコープへの影響を確認してください

### データモデル変更プロセス
1. モデル変更の必要性が生じた場合、変更内容と理由を明確に文書化
2. 大規模な構造変更の場合は事前にスコープマネージャーと協議
3. data_models.mdファイルを更新（初期設計はスコープマネージャー、拡張はスコープ実装アシスタント）
4. このファイルの変更履歴セクションを更新
5. CURRENT_STATUS.mdにも変更内容を記録
6. 他のスコープ担当者に変更を通知（影響範囲がある場合）

## モデル使用方法

このファイルで定義されたデータモデルは以下のように使用します：

```typescript
// 中央定義ファイルをインポート
import { User, Post, Comment } from '@/lib/db/models';

// データ取得例
const users = await User.findMany();

// データ作成例
const newUser = await User.create({
  data: {
    name: 'John Doe',
    email: 'john@example.com',
  }
});
```

## データモデル一覧

以下にプロジェクトで使用するデータモデルを定義します。各モデルには以下の情報が含まれます：

- モデル名: テーブル名/コレクション名
- 説明: モデルの目的と用途
- 属性: フィールド名、型、説明
- リレーション: 他のモデルとの関連
- インデックス: パフォーマンス最適化のための情報
- 最終更新日: モデル定義の最終変更日
- 更新者: 最後に変更を行った担当者

### モデルテンプレート

```typescript
// モデル名
interface ModelName {
  id: string;          // 主キー
  fieldName: DataType; // フィールド名と型
  relation: Relation;  // リレーションフィールド
  createdAt: Date;     // 作成日時
  updatedAt: Date;     // 更新日時
}

// リレーション定義
ModelName.hasMany(RelatedModel);
RelatedModel.belongsTo(ModelName);

// インデックス定義
index: ['fieldName1', 'fieldName2']

// 変更履歴
// 2025-03-09: 初期作成 (AppGenius)
```

### データモデル実装

以下に実際のデータモデルを定義します。このセクションはプロジェクトの具体的な要件に基づいて更新してください。

```typescript
// 必要に応じてデータモデルを定義
```

## データモデル変更履歴

| 日付 | モデル | 変更内容 | 変更者 | 影響スコープ |
|------|--------|----------|--------|--------------|
| 2025-03-09 | - | 初期ファイル作成 | AppGenius | - |

## スコープとデータモデルの対応表

各スコープが使用するデータモデルの対応表です。これにより、スコープ間の依存関係とモデル変更の影響範囲を把握できます。

| スコープID | スコープ名 | 使用するモデル | 読み取り/書き込み |
|------------|------------|----------------|-------------------|
| SCOPE-001 | 例：認証機能 | User, Session | 読み取り/書き込み |
| SCOPE-002 | 例：ダッシュボード | User, Project | 読み取り |

## トラブルシューティング

### よくある問題と解決策

1. **モデル定義の不一致**
   - 症状: TypeScriptの型エラーやデータベースアクセスエラー
   - 解決策: data_models.mdの最新の定義を確認し、古い定義を更新

2. **リレーションエラー**
   - 症状: 外部キー制約エラーやリレーション取得エラー
   - 解決策: リレーション定義が正しいか確認し、必要に応じてスコープマネージャーに修正提案

3. **スキーママイグレーションエラー**
   - 症状: マイグレーション適用時のエラー
   - 解決策: データモデル変更履歴を確認し、スコープマネージャーに連絡