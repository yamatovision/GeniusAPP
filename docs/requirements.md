appgenius-vscode/
├── .vscode/
│   ├── launch.json
│   └── tasks.json
├── src/
│   ├── extension.ts                  # エントリーポイント
│   ├── services/                     # 共通サービス
│   │   ├── ClaudeMdService.ts        # CLAUDE.mdファイル管理
│   │   ├── FileSystemService.ts      # ファイル操作
│   │   ├── ClaudeCodeService.ts      # ClaudeCode API連携
│   │   ├── PatternDetectionService.ts # ファイルパターン検出
│   │   └── ToastService.ts           # 通知表示
│   ├── pages/                        # ページコンポーネント
│   │   ├── Dashboard.ts              # メインダッシュボード
│   │   ├── RequirementsManager.ts    # 要件定義・構造マネージャー
│   │   ├── MockupGallery.ts          # モックアップギャラリー
│   │   ├── ScopeManager.ts           # スコープ計画マネージャー
│   │   ├── DevelopmentAssistant.ts   # 開発アシスタント（チャットUI）
│   │   ├── DebugSupport.ts           # デバッグサポート
│   │   ├── ApiIntegration.ts         # API連携・環境設定
│   │   └── DeployManager.ts          # デプロイコントロール
│   ├── components/                   # 共通UIコンポーネント
│   │   ├── Sidebar.ts                # サイドバー
│   │   ├── ChatInterface.ts          # チャットインターフェース
│   │   ├── FileExplorer.ts           # ファイルエクスプローラー
│   │   ├── CodePreview.ts            # コードプレビュー
│   │   ├── Toast.ts                  # トースト通知
│   │   └── ProgressIndicator.ts      # 進捗表示
│   ├── templates/                    # テンプレート
│   │   ├── claudemd.ts               # CLAUDE.mdテンプレート
│   │   ├── requirements.ts           # 要件定義テンプレート
│   │   ├── structure.ts              # ディレクトリ構造テンプレート
│   │   └── api.ts                    # API定義テンプレート
│   ├── utils/                        # ユーティリティ
│   │   ├── markdown.ts               # Markdown処理
│   │   ├── html.ts                   # HTML処理
│   │   ├── vscode.ts                 # VSCode API操作
│   │   └── prompts.ts                # プロンプトテンプレート
│   └── constants/                    # 定数
│       ├── commands.ts               # コマンド定義
│       ├── messages.ts               # メッセージ定義
│       └── themes.ts                 # テーマ関連定数
├── webview/                          # WebViewフロントエンド
│   ├── dashboard/                    # ダッシュボードUI
│   ├── chat/                         # チャットUI
│   └── shared/                       # 共有コンポーネント
├── media/                            # アセット
│   ├── icons/                        # アイコン
│   └── screenshots/                  # スクリーンショット
├── test/                             # テスト
│   ├── extension.test.ts             # 拡張機能テスト
│   └── services/                     # サービステスト
├── package.json                      # 拡張機能メタデータ
├── tsconfig.json                     # TypeScript設定
├── webpack.config.js                 # Webpack設定
└── README.md                         # ドキュメント



# AppGenius VSCode拡張機能 要件定義書

## 1. 製品概要

**製品名**: AppGenius VSCode拡張機能

**目的**: 非技術者がClaudeCodeを活用してアプリケーション開発を行えるようにするVSCode拡張機能。AIチャットを中心とした開発フローと、作成されたコンテンツの適切な保存・管理機能を提供する。

**主要コンセプト**:
- 「おばちゃんでもアプリが作れる」を実現するUI/UX
- AIとの対話を中心とした開発体験
- 生成コンテンツの自動保存と管理
- CLAUDE.mdを中心とした設計情報管理

## 統合開発フロー

![開発フロー概要](../media/dev_flow_diagram.png)

### Phase 1: プロジェクト設定
1. ダッシュボード起動 → 新規プロジェクト作成
2. プロジェクト名入力 → 保存先選択
3. 自動CLAUDE.md初期化

### Phase 2: 要件定義と構造設計
1. 要件定義マネージャー起動
2. AIとの会話による要件定義
   - ユーザー: 要件を自然言語で説明
   - システム: 要件を構造化し提示
   - ユーザー: 「要件定義として保存」ボタン選択
   - システム: docs/requirements.md自動生成/更新
3. ディレクトリ構造設計
   - システム: 要件に基づいた構造提案
   - ユーザー: 「ディレクトリ構造として保存」ボタン選択
   - システム: docs/structure.md自動生成/更新

### Phase 3: モックアップ設計
1. モックアップギャラリー起動
2. 要件に基づくモックアップ生成
   - 上部: モックアップ表示領域（タブ形式で複数ページ表示可能）
   - 下部: AIとの調整会話
3. モックアップの反復的改善
   - ユーザー: AIとの会話でモックアップを修正・微調整
   - システム: リアルタイムでモックアップを更新表示
4. モックアップ保存
   - ユーザー: 「モックアップを保存」選択
   - システム: mockups/フォルダに保存、CLAUDE.md参照追加
5. バックエンド要件の抽出
   - システム: モックアップからAPI要件を自動抽出
   - ユーザー: 「API定義として保存」ボタン選択
   - システム: docs/api.md自動生成/更新

### Phase 4: スコープ計画
1. スコープマネージャー起動
2. スコープ定義
   - システム: 要件/構造に基づくスコープ分割提案（20万トークン以内の単位）
   - ユーザー: スコープ調整と優先順位設定
   - システム: docs/scope.md自動生成/更新、CLAUDE.md内のチェックリスト更新
3. 依存関係の視覚化
   - システム: スコープ間の依存関係グラフを表示
   - ユーザー: 実装順序を確認・調整

### Phase 5: 実装フェーズ
1. 開発アシスタント起動
2. スコープ選択と実装
   - ユーザー: 実装するスコープ選択
   - システム: ClaudeCode起動、実装指示、スコープ情報をCLAUDE.mdから読み込み
   - システム: ファイル生成状況リアルタイム表示、CLAUDE.md内のチェックリスト自動更新
3. 環境変数設定
   - 必要に応じAPIキー等を設定
   - システム: ステップバイステップガイド表示

### Phase 6: デバッグ
1. エラー発生時デバッグサポート起動
2. エラー解析と修正提案
   - システム: エラーログ分析
   - システム: 修正箇所ハイライト
   - ユーザー: 修正適用

### Phase 7: デプロイ
1. デプロイセンター起動
2. デプロイ前チェック
3. デプロイ実行と確認

### 2. ユーザー層

- プログラミング経験の少ないビジネスユーザー
- AIを活用した開発に興味のある個人開発者
- 少人数チームの開発者・プロジェクトマネージャー

### 3. 主要機能

#### 3.1 メインダッシュボード
- プロジェクト全体の進捗状況表示
- 現在のステップと次のアクションの明確な案内
- 各開発フェーズへのクイックアクセス
- CLAUDE.mdとdocsフォルダ内の各mdファイルへのリンク
- プロジェクト全体の健全性インジケーター
- ファイル作成達成率追跡機能（計画ファイル数に対する実装済みファイル数の割合）
- 実装ステータスの視覚的表示（チェックリスト形式）

#### 3.2 要件定義・プロジェクト構造マネージャー（統合版）
- AIとの会話UIを中心としたインターフェース設計
- 会話の右側に「要件定義として出力」「ディレクトリ構造として出力」ボタンを配置
- 選択した会話ブロックを適切なフォーマットに変換して保存する機能
- docs/requirements.mdとdocs/structure.mdの一元管理
- 要件定義から自然にディレクトリ構造策定へ流れるUI
- 要件カテゴリごとにディレクトリ構造が提案される連携機能
- 構造化された要件入力と、それに対応するディレクトリ構造の視覚的表示
- 要件変更時のディレクトリ構造への影響表示
- 会話履歴から要件とディレクトリ構造を自動抽出する機能

#### 3.3 モックアップギャラリー
- 要件定義書を読み込んでページ分析を行う機能
- 必要なページのモックアップを並列生成する機能
- 上部：複数ページのモックアップをタブ形式で表示・切替
- 下部：AIとの会話による詳細調整インターフェース
- 「モックアップを保存」ボタンでmockupsフォルダに適切なファイル名で自動保存
- モックアップ保存時にCLAUDE.mdへの自動参照追加
- モックアップ間の関連性・フロー表示
- 動線や詳細をAIと会話で修正できるインターフェース
- モックアップをクリックすると関連するコンポーネントやファイル構成を表示
- ClaudeCodeでモックアップを読み込ませて修正できる仕組み
- モックアップからバックエンド連携要件（API、データモデル）を自動抽出する機能
- 非技術者が視覚的に確認・フィードバックできるインタラクティブなプレビュー

#### 3.4 スコープ計画マネージャー
- モックアップからページごとの関連ファイル一覧を自動抽出
- ファイル一覧をスコープとして設定できる機能
- docs/scope.mdの編集と管理
- 実装機能の最適な分割提案（20万トークン以内の適切な単位に分割）
- ClaudeCodeの並列実装のための最適スコープ決定
- 依存関係の可視化と実装順序の最適化
- 各スコープの難易度・工数予測
- スコープごとの進捗状況をリアルタイム表示
- フロントエンドからバックエンドまでの一貫したスコープ設計
- ファイル単位の実装追跡システム（ディレクトリ構造から実装対象ファイルを特定し、CLAUDE.mdに「実装対象ファイル」セクションとして追加）
- ファイル単位のチェックリスト生成とステータス管理（実装完了/未完了）
- CLAUDE.mdに統合されたスコープチェックリストの自動更新機能
- スコープ実装の進捗を視覚的に表示するダッシュボード連携
- 非技術者にも理解しやすいスコープの説明と進捗状況の可視化

#### 3.5 開発リファレンスマネージャー
- docs/api.mdの編集と管理
- 開発に必要な外部APIリファレンス集約
- サンプルコード・スニペット管理
- ClaudeCodeの実装効率化のための情報整理
- ライブラリ・フレームワークのリファレンス統合

#### 3.6 開発アシスタント（チャットUI）
- ClaudeCodeとの対話インターフェース
- スコープ選択機能とスコープ実装開始ボタン
- スコープ単位での実装状況リアルタイム表示
- ファイル生成のプレビューと編集
- 進捗トラッキングとステータス表示
- スコープ実装中のファイル生成状況をリアルタイム表示
- スコープ完了チェックリスト
- AIとの会話からコードやファイルを抽出する機能
- 抽出したコンテンツを適切なファイルとして保存するエクスポート機能
- プロジェクトファイルの管理とプレビュー
- 環境変数設定ポイントの自動検出と設定ガイド表示
- CLAUDE.mdからスコープ情報を読み込みClaudeCodeに初期プロンプトとして提供
- ファイル生成時にCLAUDE.mdのチェックリストを自動更新する機能
- モックアップを読み込んでClaudeCodeに提供し、視覚的情報に基づいた実装を促進
- 進捗状況の可視化とユーザーへのリアルタイムフィードバック

#### 3.7 デバッグサポートセンター
- エラーログ専用mdファイルの管理
- エラーの自動フォーマットとClaudeCode用要約
- エラーパターンの認識と解決策データベース
- 視覚的なエラー原因特定ガイド
- 修正箇所のハイライトと修正提案

#### 3.8 API連携・環境設定アシスタント
- 開発中に検出された環境変数設定ポイントを集約表示
- docs/env.exampleの編集と管理
- 外部APIセットアップガイド（スクリーンショット付き）
- ステップバイステップの視覚的セットアップ手順
- シークレットキー管理のベストプラクティス案内
- APIテスト機能と接続確認
- ユーザーがアップロードしたスクリーンショットを基にしたガイド作成
- 環境変数設定のウィザード形式ガイド
- 設定済み環境変数の一覧表示と管理
- APIキー設定状況の健全性チェック

#### 3.9 デプロイコントロールセンター
- デプロイ前チェックリスト
- ワンクリックGitHub連携
- デプロイプラットフォーム選択ガイド
- デプロイログの実時間表示
- 公開後の動作確認ツール

### 4. ファイル構造と保存

#### 4.1 フォルダ構造
- docs/ - ドキュメント用フォルダ
- mockups/ - モックアップ画像用フォルダ

#### 4.2 生成ファイル
- CLAUDE.md - プロジェクトの中心的なドキュメント
- docs/requirements.md - 要件定義書
- docs/structure.md - ディレクトリ構造定義
- docs/scope.md - 実装スコープ定義
- docs/api.md - API仕様書
- docs/env.example - 環境変数設定例
- docs/errors.md - エラーログと解決策

#### 4.3 保存フロー
- AIチャットから生成されたコンテンツを選択
- エクスポートメニューから保存先を選択
- 適切なファイルに自動保存
- 保存完了時にトースト通知で確認

### 5. UI/UX設計のポイント

#### 5.1 AIチャットUI
- 非技術者でも使いやすいシンプルなチャットインターフェース
- コード・モックアップ・図表などの視覚的コンテンツの適切な表示
- 会話ブロックの右側にエクスポートボタンを配置
- エクスポート操作のわかりやすい表示
- プロンプトテンプレートによる入力サポート
- 会話履歴からのコンテンツ抽出機能

#### 5.2 ファイル管理UI
- サイドパネルによるプロジェクトファイルの直感的な表示
- ファイルタイプ別の整理と視覚的アイコン
- ファイル操作のコンテキストメニュー
- ディレクトリ構造の視覚的表現
- 生成ファイルのリアルタイム表示

#### 5.3 プレビューとフィードバック
- モックアップのリアルタイムプレビュー
- マルチタブ表示によるモックアップ切替
- スコープ実装状況のリアルタイム表示
- トースト通知による操作完了の確認
- エラーと警告の明確な表示
- 進捗状況の視覚的フィードバック
- 生成ファイルのプレビューとエディタ連携

#### 5.4 エクスポートと保存
- AIとの会話から生成したコンテンツの保存機能
- 会話ブロックを選択して適切なファイルに出力
- 保存先の自動推定とユーザー選択オプション
- ファイル名自動生成と編集オプション
- ファイル保存後の確認通知

### 6. 技術要件

#### 6.1 VSCode連携
- VSCode拡張API活用
- WebViewパネルでのリッチUIの実現
- VSCodeテーマとの統合（カラー変数の使用）
- VSCode組み込みコマンドとの連携

#### 6.2 ClaudeCode連携
- ClaudeCode APIとの安全な通信
- 会話コンテキストの管理
- プロンプトの最適化と管理
- APIレスポンスのパース処理
- スコープをClaudeCodeに渡す最適化（20万トークン以内の適切なサイズで分割）
- CLAUDE.mdからスコープ情報を読み込み初期プロンプトとして設定
- ClaudeCode生成ファイルのリアルタイム監視
- 並列生成の効率的な管理
- ファイル生成状況のリアルタイム同期と進捗率計算
- 生成ファイルの適切なフォーマット処理
- ファイル作成検出システム（作成されたファイルを検出し、CLAUDE.mdのチェックリストを自動更新）
- 実装達成率の計算と表示（計画ファイル数に対する実装済みファイル数の割合）
- モックアップHTMLをClaudeCodeに提供し視覚的情報に基づく実装を支援
- バックエンド連携要件（API定義、データモデル）をClaudeCodeに提供するインターフェース
- ユーザーに見えない形で初期設定や特殊指示をClaudeCodeに伝達する仕組み

#### 6.3 ファイル操作
- ファイルの自動生成
- ディレクトリ作成
- ファイル内容の解析と修正
- パターン検出と自動適用

### 7. 拡張性と将来の展望

#### 7.1 プラグインシステム
- 追加機能のプラグインとしての拡張性
- カスタムテンプレートの追加

#### 7.2 将来拡張機能
- チーム連携機能
- バージョン管理の強化
- CI/CD連携の強化
- 機械学習によるエラー予測

### 8. 最小実用製品（MVP）スコープ

以下の機能すべてを含む完全実装：
- メインダッシュボード
- 要件定義・プロジェクト構造マネージャー
- モックアップギャラリー
- スコープ計画マネージャー
- 開発リファレンスマネージャー
- 開発アシスタント（チャットUI）
- デバッグサポートセンター
- API連携・環境設定アシスタント
- デプロイコントロールセンター

### 9. 実装の優先順位と開発ロードマップ

#### フェーズ1：基盤構築 (2-3週間)
1. 開発アシスタント（チャットUI）- AIとの対話を中心とした開発フロー
2. CLAUDE.md管理システム - プロジェクト情報の中央リポジトリ
3. メインダッシュボード - 開発フローの可視化

#### フェーズ2：設計フェーズツール (2-3週間)
4. 要件定義・プロジェクト構造マネージャー - 基本的な開発設計
5. モックアップギャラリー - 視覚的な設計
6. スコープ計画マネージャー - 実装計画の最適化

#### フェーズ3：実装フェーズツール (3-4週間)
7. 開発リファレンスマネージャー - 開発情報の整理
8. ClaudeCode実装連携 - スコープからファイル生成までの自動化
9. デバッグサポートセンター - 開発中のトラブルシューティング

#### フェーズ4：完成フェーズツール (2-3週間)
10. API連携・環境設定アシスタント - 環境変数とAPI設定の管理
11. デプロイコントロールセンター - 完成アプリのデプロイ
12. 総合機能テストと最適化

### 10. リリース計画

#### MVP版 (8週間)
- 基本的なAIチャットインターフェース
- 要件定義とディレクトリ構造の出力
- シンプルなモックアップ生成と保存
- 基本的なスコープ設定機能
- ClaudeCode連携の基本機能

#### ベータ版 (12週間)
- 全機能の基本実装
- ユーザーフィードバックを基にした改善
- パフォーマンス最適化

#### 製品版 (16週間)
- 全機能の完全実装
- 高度なUI/UX改善
- 詳細なドキュメント整備
- チュートリアルと例示プロジェクト

以上がAppGenius VSCode拡張機能の詳細な要件定義です。「おばちゃんでもアプリが作れる」という目標に向けて、AIとの対話を中心に据えながら、生成されるコンテンツを適切に管理・保存する機能を提供します。