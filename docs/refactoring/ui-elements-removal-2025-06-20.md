# リファクタリング計画: UI要素削除（プロジェクトタブ・LPレプリカ見出し） [2025-06-20]

## 1. 現状分析

### 1.1 対象概要
VSCode拡張機能のメインUIにおいて、不要なUI要素を削除してシンプルなインターフェースを実現します。削除対象は、メインコンテンツエリア上部のプロジェクト名タブと、LPレプリカセクションの「LPレプリカ作成」見出しです。

### 1.2 問題点と課題
- プロジェクト名タブが画面上部のスペースを占有し、視覚的にノイズになっている
- 左側のプロジェクトナビゲーションで既に選択中のプロジェクトが明確なため、上部のタブ表示は冗長
- 「LPレプリカ作成」の見出しも、機能が明確なため不要
- タブバー自体は既に削除されているが、プロジェクト表示部分が残存している

### 1.3 関連ファイル一覧
- `/src/ui/scopeManager/templates/ScopeManagerTemplate.ts` - HTMLテンプレート
- `/media/scopeManager.css` - スタイル定義
- `/media/components/projectNavigation/projectNavigation.js` - プロジェクト名更新処理
- `/media/scopeManager.js` - プロジェクト名更新イベント発火
- `/media/components/dialogManager/dialogManager.js` - ダイアログ内でのプロジェクト名参照

### 1.4 依存関係図
```
ScopeManagerTemplate.ts（HTMLテンプレート）
    ├── project-display要素を定義
    └── LPレプリカ見出しを定義
         ↓
projectNavigation.js
    ├── project-display内のproject-name要素を参照
    └── project-name-updatedイベントをリスン
         ↓
scopeManager.js
    └── project-name-updatedイベントを発火
```

## 2. リファクタリングの目標

### 2.1 期待される成果
- UI要素の削除により、垂直方向のスペースを約50px節約
- 視覚的なクリーンさの向上、ユーザーの注目がメインコンテンツに集中
- 不要なDOM要素とCSSルールの削除により、約100行のコード削減
- プロジェクト名表示の冗長性を排除

### 2.2 維持すべき機能
- プロジェクトナビゲーションでの現在選択中プロジェクトの表示
- LPレプリカ機能の全ての動作
- レスポンシブデザインの維持

## 3. 理想的な実装

### 3.1 全体アーキテクチャ
削除後は、メインコンテンツエリアにLPレプリカコンテンツが直接表示される構造になります。タブエリアが完全に削除され、よりシンプルなレイアウトが実現されます。

### 3.2 核心的な改善ポイント
- プロジェクト名の表示は左側のプロジェクトナビゲーションのみに統一
- タブコンテナ全体（.tabs）を削除し、LPレプリカコンテンツを直接配置
- 不要なイベントリスナーとDOM参照の削除

### 3.3 新しいディレクトリ構造
```
変更なし（ファイル構造は維持、内容のみ変更）
```

## 4. 実装計画

### フェーズ1: HTMLテンプレートの更新
- **目標**: プロジェクトタブとLPレプリカ見出しをHTMLから削除
- **影響範囲**: ScopeManagerTemplate.ts
- **タスク**:
  1. **T1.1**: タブコンテナの削除
     - 対象: ScopeManagerTemplate.ts:196-202行目
     - 実装: `<div class="tabs">...</div>`全体を削除
  2. **T1.2**: LPレプリカ見出しの削除
     - 対象: ScopeManagerTemplate.ts:267行目
     - 実装: `<h3>LPレプリカ作成</h3>`を削除
- **検証ポイント**:
  - 拡張機能を再読み込みして画面表示を確認
  - LPレプリカ機能が正常に動作することを確認

### フェーズ2: JavaScript依存の解消
- **目標**: 削除した要素への参照を安全に処理
- **影響範囲**: projectNavigation.js, scopeManager.js
- **タスク**:
  1. **T2.1**: projectNavigation.jsの更新
     - 対象: projectNavigation.js:12行目、49-51行目、607-630行目
     - 実装: projectDisplayName要素への参照を条件付きに変更、updateProjectName()メソッドの安全な処理
  2. **T2.2**: イベントリスナーの調整
     - 対象: projectNavigation.js:49-51行目
     - 実装: project-name-updatedイベントリスナーを維持（将来の拡張性のため）
- **検証ポイント**:
  - プロジェクト切り替え時にエラーが発生しないこと
  - コンソールにエラーログが出力されないこと

### フェーズ3: CSS削減
- **目標**: 不要になったCSSルールを削除
- **影響範囲**: scopeManager.css
- **タスク**:
  1. **T3.1**: タブ関連CSSの削除
     - 対象: scopeManager.css:294-339行目
     - 実装: .tabs, .tabs-container, .tab関連のルールを削除
  2. **T3.2**: プロジェクト表示CSSの削除
     - 対象: scopeManager.css:342-368行目
     - 実装: .project-display, .project-name, .project-path-display関連のルールを削除
  3. **T3.3**: レスポンシブ対応CSSの削除
     - 対象: scopeManager.css:1591-1593行目、1607-1614行目
     - 実装: タブ関連のレスポンシブルールを削除
- **検証ポイント**:
  - レイアウトが崩れていないこと
  - 不要なスペースが残っていないこと

### フェーズ4: 最終調整とクリーンアップ
- **目標**: 全体的な動作確認と微調整
- **影響範囲**: 全関連ファイル
- **タスク**:
  1. **T4.1**: コンテンツエリアの上部マージン調整
     - 対象: scopeManager.css（必要に応じて）
     - 実装: LPレプリカコンテンツの上部スペースを適切に調整
  2. **T4.2**: 不要なコメントの削除
     - 対象: 全ファイル
     - 実装: タブ関連のコメントを削除
- **検証ポイント**:
  - 全機能が正常に動作すること
  - UIが視覚的にクリーンであること

## 5. 期待される効果

### 5.1 コード削減
- HTML: 約10行削減
- CSS: 約90行削減
- 合計: 約100行削減（約5%のコード削減）

### 5.2 保守性向上
- UI構造のシンプル化により、将来の変更が容易に
- 不要な依存関係の排除により、バグのリスクが減少
- コードの可読性向上

### 5.3 拡張性改善
- よりシンプルな構造により、新機能の追加が容易に
- 画面スペースの有効活用が可能に

## 6. リスクと対策

### 6.1 潜在的リスク
- プロジェクト名が表示されなくなることによるユーザーの混乱
- JavaScript参照エラーによる機能停止
- レイアウトの崩れ

### 6.2 対策
- 左側のプロジェクトナビゲーションで選択中のプロジェクトを明確に表示
- DOM要素への参照を条件付きにして、要素が存在しない場合も安全に処理
- 各フェーズ後に動作確認を実施

## 7. 備考
- 将来的にプロジェクト名の表示が必要になった場合は、左側のナビゲーションエリアを拡張することを推奨
- タブUIが必要になった場合は、新しい設計で実装することを推奨（現在の実装は複雑すぎる）